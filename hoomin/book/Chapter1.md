# 1장


on-premise 환경에 플랫폼을 배포 / 컴포넌트는 독립적인 소프트웨어 
 
#### 독립 소프트웨어 컴포넌트의 장점
- 독립적으로 시스템 환경에 배포할 수 있다.
- 독립적으로 업그레이드 할 수 있다.
- 독립적으로 스케일 아웃 할 수 있다.
- 서비스를 소유한 독립적인 소규모 팀(구성원) 육성 가능 / 서비스를 소유한 팀(구성원)의 해당 서비스 개발 시간 감소
- 지속적 통합 및 지속적 전달을 통해 쉽게 코드 배포
- 각 컴포넌트의 기술적 자유 / 가장 적합한 도구를 자유롭게 선택 가능
- 코드 재사용 / 모듈로 분할해 여러 용도로 사용 가능 
    - 중복 코드도 늘어날거 같은데
- 한 컴포넌트가 실패시 기능을 저하시키고 전체 어플리케이션을 충돌시키지 않는 방법으로 처리 가능

#### 독립 소프트웨어 컴포넌트의 단점
- 컴포넌트의 인스턴스를 추가하려면 수동으로 로드 밸런서와 노드를 설정해야한다.
    - AWS 로드밸런서만 쓰면 안되는걸까? / 로드밸런싱 로직을 프로그래밍으로 구현한다는 이점?
-  다른 시스템에서 오류가 발생했을때 플랫폼으로 전이된다. (연쇄장애)
    - 다른 시스템이 요청을 제시간에 응답하지 않으면 스레드와 같은 자원이 부족하게 된다.
- 모든 컴포넌트 인스턴스의 구성을 일관성 있게 최신 상태로 유지하는 작업에도 많은 문제가 있다.
    - 어떤 문제가 있을까?
- 지연시간, 하드웨어 사용량 측면에서 일체형 어플리케이션에 비해 모니터링 작업이 훨씬 복잡하다.
- 분산된 컴퓨넌트들에서 로그 파일을 관리하는건 어려운 작업이다.
> 이 문제점들은 자체 개발 도구와 수동 처리를 위한 문서화된 지침으로 해결할 수 있다.

##### 왜 MSA?
- 일체형 어플리케이션을 유지보수하고 개선하는건 점점 더 어려워진다.   
- 스케일업의 한계
    - 스케일아웃으로 해결하면 되지 않을까?
- 독립적으로 출시 및 스케일링이 가능하다.
    - MSA를 하면 인스턴스가 많아질텐데 배보다 배꼽이 크진 않을까?

> AWS 기반 마이크로서비스 구성하기
> https://d2908q01vomqb2.cloudfront.net/7b52009b64fd0a2a49e6d8a939753077792b0554/2018/12/21/2018-wp-microservice-on-aws.pdf

##### 키워드들
넷플릭스 OSS / 스프링 클라우드 / 도커 / 컨테이너 오케스트레이터 / 쿠버네티스 / 서비스 메시

#### MSA와 JPA
일체형 어플리케이션에서 단순 join 으로 조회하는 DB를 MSA와 JPA를 적용한 어플리케이션에서는 어떻게 구현해야 할까?   
논란의 여지가 있는것 같지만 MSA에서 DB는 완전히 분리된 시스템이어야 한다. DB 장애나면 다 죽는다.    
   
같은 엔티티여도 컴포넌트에 따라 다른 엔티티이다.   
이게 이제 Bounded Context(도메인의 경계)에 따라서 같은 단어도 다른 뜻으로 해석할 수 있는 것이지요.   
예를 들어서 주문 시스템에서 생각하는 Order데이터는 정말 중요한 주문의 핵심 데이터 입니다.    
만약 주문의 결과를 이벤트로 전파하게 되면 필요한 시스템에서 Order 데이터를 받을 수 있습니다.   
그런데 예를 들어서 리뷰를 남길 때 주문 정보가 약간 필요해서 리뷰 시스템에서 주문 데이터를 저장한다면,      
본인 시스템에 필요한 주문 데이터로 변환해서 (변환 계층) 완전히 다른 주문 데이터로 다루게 됩니다.      
결국 주문 시스템의 주문 엔티티와 리뷰 시스템에서 받아서 사용하는 주문 엔티티는 완전히 다른 주문 엔티티 입니다.   
따라서 MSA 입장에서 이건 중복이라기 보다는, 본인의 시스템에 맞는 도메인으로 변환된 것이지요. 리뷰 시스템 입장에서는 데이터는 외부에서 흘러들어오지만 본인의 도메인에 맞추어 정리된 엔티티이기 때문에,    필요하면 연관관계를 맺어서 사용해도 됩니다.(물론 연관관계를 안 맺는게 더 나은 경우도 있습니다. 이건 상황에 따라서 조금씩 달라집니다.)
> https://www.inflearn.com/questions/27579
